import{r as c,j as e,C as L,O as P,S,u as R,T as k,R as C,a as w}from"./three-CAID0dhZ.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const g=4,y=3,b=2,j=60,z=2e3,p=.5,I=.3;function M(t){const[n,o]=c.useState({score:0,playerX:0,playerY:0,playerZ:0,isPlaying:!0,timeLeft:j,combo:0,highScore:0,targetSize:p,level:1,isNewHighScore:!1}),i=c.useRef(null),r=c.useRef(null);c.useEffect(()=>()=>{i.current!==null&&clearTimeout(i.current),r.current!==null&&clearInterval(r.current)},[]),c.useEffect(()=>(n.isPlaying&&n.timeLeft>0?(r.current!==null&&clearInterval(r.current),r.current=setInterval(()=>{o(a=>{const f=a.timeLeft-1;if(f<=0){const u=a.score>a.highScore;return{...a,timeLeft:0,isPlaying:!1,highScore:Math.max(a.highScore,a.score),isNewHighScore:u}}return{...a,timeLeft:f}})},1e3)):r.current!==null&&(clearInterval(r.current),r.current=null),()=>{r.current!==null&&clearInterval(r.current)}),[n.isPlaying,n.timeLeft]);const s=c.useCallback(()=>{o(a=>{const f=a.combo+1,u=Math.floor(f/5),x=a.score+1+u,m=Math.floor(x/10)+1,E=Math.max(I,p-(m-1)*.05);return{...a,score:x,combo:f,level:m,targetSize:E,playerX:Math.random()*g-g/2,playerY:Math.random()*y-y/2,playerZ:Math.random()*b-b/2}}),i.current!==null&&clearTimeout(i.current),i.current=setTimeout(()=>{o(a=>({...a,combo:0}))},z)},[]),l=c.useCallback(()=>{i.current!==null&&clearTimeout(i.current),r.current!==null&&clearInterval(r.current),o(a=>({score:0,playerX:0,playerY:0,playerZ:0,isPlaying:!0,timeLeft:j,combo:0,highScore:a.highScore,targetSize:p,level:1,isNewHighScore:!1}))},[]),d=c.useCallback(()=>{o(a=>({...a,isPlaying:!a.isPlaying}))},[]);return{gameState:n,incrementScore:s,resetGame:l,togglePause:d}}function T({position:t,onClick:n,isActive:o,size:i}){const r=c.useRef(null),[s,l]=c.useState(!1);R(a=>{!o||!r.current||(r.current.rotation.y+=.02,r.current.rotation.x=Math.sin(a.clock.elapsedTime*2)*.1,r.current.position.y=t[1]+Math.sin(a.clock.elapsedTime*3)*.1)});const d=c.useCallback(a=>{a.stopPropagation(),o&&n()},[o,n]);return e.jsxs("group",{position:t,children:[e.jsx(k,{width:3,length:6,color:o?"#00ff88":"#666666",attenuation:a=>a*a,children:e.jsxs("mesh",{ref:r,onClick:d,onPointerOver:()=>o&&l(!0),onPointerOut:()=>l(!1),scale:o?s?1.3:1:.6,"data-testid":"target-sphere",children:[e.jsx("sphereGeometry",{args:[i,32,32]}),e.jsx("meshStandardMaterial",{color:o?s?"#00ff88":"#00cc66":"#666666",emissive:o?"#00ff88":"#333333",emissiveIntensity:s?.8:.4,metalness:.5,roughness:.2}),e.jsxs("mesh",{position:[0,0,0],children:[e.jsx("torusGeometry",{args:[i*.7,.02,16,32]}),e.jsx("meshStandardMaterial",{color:o?"#ffffff":"#999999",transparent:!0,opacity:.8,emissive:"#ffffff",emissiveIntensity:s?.5:.2})]}),e.jsxs("mesh",{position:[0,0,0],children:[e.jsx("torusGeometry",{args:[i*.4,.02,16,32]}),e.jsx("meshStandardMaterial",{color:o?"#ffffff":"#999999",transparent:!0,opacity:.8,emissive:"#ffffff",emissiveIntensity:s?.5:.2})]})]})}),o&&e.jsx(S,{count:20,scale:i*3,size:2,speed:.4,color:"#00ff88"})]})}function B(){return e.jsx(S,{count:100,scale:15,size:1,speed:.2,opacity:.3,color:"#646cff"})}function O({gameState:t,onTargetClick:n}){const o=c.useCallback(()=>{!t.isPlaying||t.timeLeft<=0||n()},[t.isPlaying,t.timeLeft,n]),i=t.timeLeft<=0;return e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.3}),e.jsx("pointLight",{position:[10,10,10],intensity:1,color:"#ffffff"}),e.jsx("pointLight",{position:[-10,-10,-5],intensity:.5,color:"#646cff"}),e.jsx("spotLight",{position:[0,10,0],angle:.6,penumbra:1,intensity:.5,castShadow:!0,color:"#00ff88"}),e.jsx(B,{}),e.jsx(T,{position:[t.playerX,t.playerY,t.playerZ],onClick:o,isActive:t.isPlaying&&!i,size:t.targetSize}),e.jsx("gridHelper",{args:[10,10,"#30363d","#21262d"],position:[0,-2,0]}),e.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-2.01,0],receiveShadow:!0,children:[e.jsx("planeGeometry",{args:[10,10]}),e.jsx("meshStandardMaterial",{color:"#0d1117",opacity:.8,transparent:!0})]}),e.jsx(P,{enablePan:!1,enableZoom:!0,minDistance:3,maxDistance:15,maxPolarAngle:Math.PI/2})]})}function G(){const{gameState:t,incrementScore:n,resetGame:o,togglePause:i}=M();return e.jsxs("div",{className:"app-container","data-testid":"app-container",children:[e.jsx("h1",{"data-testid":"app-title",children:" Target Shooter"}),e.jsxs("div",{style:{position:"absolute",top:"60px",left:"20px",zIndex:10,display:"flex",gap:"20px"},children:[e.jsxs("div",{"data-testid":"timer-display",style:{background:"rgba(33, 38, 45, 0.7)",padding:"10px 20px",borderRadius:"8px",backdropFilter:"blur(10px)"},children:[e.jsx("div",{style:{color:"#7d8590",fontSize:"10px",marginBottom:"4px"},children:"TIME"}),e.jsxs("div",{style:{color:t.timeLeft<=10?"#ff4444":"#00ff88",fontSize:"24px",fontWeight:"bold"},children:[t.timeLeft,"s"]})]}),e.jsxs("div",{"data-testid":"score-display",style:{background:"rgba(33, 38, 45, 0.7)",padding:"10px 20px",borderRadius:"8px",backdropFilter:"blur(10px)"},children:[e.jsx("div",{"data-testid":"score-label",style:{color:"#7d8590",fontSize:"10px",marginBottom:"4px"},children:"SCORE"}),e.jsx("div",{"data-testid":"score-value",style:{color:"#00ff88",fontSize:"24px",fontWeight:"bold"},children:t.score}),t.combo>0&&e.jsxs("div",{style:{color:"#ffa500",fontSize:"12px"},children:[" COMBO x",t.combo]})]}),e.jsxs("div",{"data-testid":"level-display",style:{background:"rgba(33, 38, 45, 0.7)",padding:"10px 20px",borderRadius:"8px",backdropFilter:"blur(10px)"},children:[e.jsx("div",{style:{color:"#7d8590",fontSize:"10px",marginBottom:"4px"},children:"LEVEL"}),e.jsx("div",{style:{color:"#646cff",fontSize:"24px",fontWeight:"bold"},children:t.level}),t.highScore>0&&e.jsxs("div",{style:{color:"#ffa500",fontSize:"10px"},children:["HIGH: ",t.highScore]})]})]}),e.jsxs("div",{style:{position:"absolute",top:"60px",right:"20px",zIndex:10,display:"flex",gap:"10px",alignItems:"center"},children:[e.jsx("div",{"data-testid":"game-status",style:{background:"rgba(33, 38, 45, 0.7)",padding:"8px 16px",borderRadius:"8px",backdropFilter:"blur(10px)",color:t.isPlaying&&t.timeLeft>0?"#00ff88":"#ffa500",fontSize:"14px",fontWeight:"bold"},children:t.timeLeft<=0?"憋 Time's Up!":t.isPlaying?" Active":"革 Paused"}),e.jsx("button",{onClick:i,"data-testid":"pause-button",disabled:t.timeLeft<=0,style:{background:t.timeLeft<=0?"#666666":t.isPlaying?"#ff6b35":"#00c851",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",cursor:t.timeLeft<=0?"not-allowed":"pointer",fontWeight:"bold",fontSize:"14px"},children:t.isPlaying?"革 Pause":"讹 Resume"}),e.jsx("button",{onClick:o,"data-testid":"reset-button",style:{background:"#7c3aed",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px"},children:" Reset"})]}),e.jsx("div",{"data-testid":"instructions-text",style:{position:"absolute",bottom:"80px",left:"50%",transform:"translateX(-50%)",zIndex:10,background:"rgba(33, 38, 45, 0.7)",padding:"12px 20px",borderRadius:"12px",backdropFilter:"blur(10px)",color:t.isPlaying&&t.timeLeft>0?"#ffffff":"#7d8590",fontSize:"16px",textAlign:"center"},children:t.timeLeft<=0?` Game Over! Final Score: ${t.score} - Click Reset to play again`:t.isPlaying?" Click the target to score! Build combos for bonus points!":"革 Game paused - Resume to continue"}),!t.isPlaying&&t.timeLeft>0&&e.jsxs("div",{"data-testid":"pause-overlay",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:20,background:"rgba(0, 0, 0, 0.85)",padding:"40px 60px",borderRadius:"20px",textAlign:"center",backdropFilter:"blur(20px)",border:"2px solid rgba(100, 108, 255, 0.5)"},children:[e.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"革"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"28px",fontWeight:"bold"},children:"GAME PAUSED"})]}),t.timeLeft<=0&&e.jsxs("div",{"data-testid":"gameover-overlay",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:20,background:"rgba(0, 0, 0, 0.85)",padding:"40px 60px",borderRadius:"20px",textAlign:"center",backdropFilter:"blur(20px)",border:"2px solid rgba(255, 68, 68, 0.5)"},children:[e.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:""}),e.jsx("div",{style:{color:"#ffffff",fontSize:"28px",fontWeight:"bold",marginBottom:"16px"},children:"GAME OVER"}),e.jsx("div",{style:{color:"#00ff88",fontSize:"48px",fontWeight:"bold",marginBottom:"8px"},children:t.score}),e.jsx("div",{style:{color:"#7d8590",fontSize:"16px"},children:t.isNewHighScore&&t.score>0?" New High Score!":`High Score: ${t.highScore}`})]}),e.jsx("div",{"data-testid":"threejs-canvas-container",style:{width:"100%",height:"600px"},children:e.jsx(L,{camera:{position:[0,2,8],fov:50},style:{background:"linear-gradient(135deg, #0d1117 0%, #1a1f2e 100%)"},"data-testid":"threejs-canvas",shadows:!0,children:e.jsx(O,{gameState:t,onTargetClick:n})})}),e.jsx("p",{className:"instructions","data-testid":"app-instructions",children:"An immersive 3D target shooting game with combos, levels, and time pressure!"})]})}const N=c.createContext(null),h={didCatch:!1,error:null};class A extends c.Component{constructor(n){super(n),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=h}static getDerivedStateFromError(n){return{didCatch:!0,error:n}}resetErrorBoundary(){const{error:n}=this.state;if(n!==null){for(var o,i,r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];(o=(i=this.props).onReset)===null||o===void 0||o.call(i,{args:s,reason:"imperative-api"}),this.setState(h)}}componentDidCatch(n,o){var i,r;(i=(r=this.props).onError)===null||i===void 0||i.call(r,n,o)}componentDidUpdate(n,o){const{didCatch:i}=this.state,{resetKeys:r}=this.props;if(i&&o.error!==null&&F(n.resetKeys,r)){var s,l;(s=(l=this.props).onReset)===null||s===void 0||s.call(l,{next:r,prev:n.resetKeys,reason:"keys"}),this.setState(h)}}render(){const{children:n,fallbackRender:o,FallbackComponent:i,fallback:r}=this.props,{didCatch:s,error:l}=this.state;let d=n;if(s){const a={error:l,resetErrorBoundary:this.resetErrorBoundary};if(typeof o=="function")d=o(a);else if(i)d=c.createElement(i,a);else if(r!==void 0)d=r;else throw l}return c.createElement(N.Provider,{value:{didCatch:s,error:l,resetErrorBoundary:this.resetErrorBoundary}},d)}}function F(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==n.length||t.some((o,i)=>!Object.is(o,n[i]))}function H({error:t}){return e.jsxs("div",{className:"error-container",children:[e.jsx("h2",{children:"Something went wrong:"}),e.jsx("pre",{children:t.message}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Try again"})]})}const v=document.getElementById("root");if(!v)throw new Error("Root element not found");C.createRoot(v).render(e.jsx(w.StrictMode,{children:e.jsx(A,{FallbackComponent:H,children:e.jsx(G,{})})}));
